extends Node

enum{
	STOP,
	BEGIN,
	SCAN,
	CACHE,
	CHANGE,
	COMPLETE,
}
var stage = 0
var coroutine = null

func stop():
	stage = STOP
	yield()

func begin():

	stage = BEGIN
	emit_signal("progress", stage)
	yield()

	stage = SCAN
	$AnimationPlayer.play("due")
	yield()

	stage = CACHE
	yield()

	stage = CHANGE
	yield()
	
	stage = COMPLETE
	coroutine = begin()

func progress_stage(target=null): #this is a safegaurd
	if target == null or target == stage + 1: #haven't decided whether this check should bedone by the caller or here
		coroutine.resume()

func _ready():
	coroutine = begin()

signal progress(stage)